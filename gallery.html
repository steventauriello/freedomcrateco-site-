<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gallery • Freedom Crate Co.</title>
  <meta name="description" content="Customer photos and past builds from Freedom Crate Co.—functional, hand-built crates for the range and display.">
  <link rel="canonical" href="https://freedomcrateco.com/gallery.html">
  <link rel="stylesheet" href="assets/css/styles.css" />
  <style>
    .hero-gallery{padding:2.5rem 1rem 1rem}
    .grid {display:grid; gap:.75rem; grid-template-columns: repeat(2, 1fr);}
    @media (min-width: 900px){ .grid{grid-template-columns: repeat(4, 1fr);} }
    .grid figure{margin:0; border-radius:.5rem; overflow:hidden; border:1px solid rgba(255,255,255,.08); background:#111}
    .grid img{width:100%; height:160px; object-fit:cover; display:block}
    .grid figcaption{font-size:.85rem; padding:.5rem; opacity:.9}
    /* You already have these styles in your page: */
    .tagbar{display:flex; gap:.5rem; flex-wrap:wrap; margin:.5rem 0 1rem}
    .tag{border:1px solid rgba(255,255,255,.2); background:rgba(255,255,255,.06); border-radius:.35rem; padding:.25rem .5rem; cursor:pointer}
    .tag[aria-pressed="true"]{outline:2px solid rgba(255,255,255,.45)}
    .lightbox-backdrop{position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.8); z-index:9999}
    .lightbox-backdrop[open]{display:grid}
    .lightbox-img{max-width:min(1200px,92vw); max-height:86vh; border-radius:.5rem}
    .close-btn{position:absolute; top:1rem; right:1rem; background:#000; color:#fff; border:1px solid rgba(255,255,255,.25); padding:.35rem .6rem; border-radius:.35rem}
  </style>
</head>
<body>
  <header class="site-header">
    <a class="brand" href="index.html"><img src="assets/img/logo.png" alt="Freedom Crate Co." height="60" width="60"></a>
    <nav class="nav" aria-label="Primary">
      <a href="index.html">Shop</a>
      <a href="contact.html">Custom Orders</a>
      <a href="reviews.html">Reviews</a>
      <a href="checkout.html">Cart (<span id="cartCount">0</span>)</a>
      <a href="about.html">About</a>
      <a href="gallery.html" aria-current="page">Gallery</a>
    </nav>
  </header>

  <main class="container">
    <section class="hero-gallery">
      <h1>Gallery</h1>
      <p class="lede">Customer photos & past builds. Want yours featured? Send pics after delivery or tag us on social.</p>

      <!-- FILTER BUTTONS (only these 3, in order) -->
      <div class="tagbar" id="tagbar">
        <button class="tag" type="button" data-tag="Customer" aria-pressed="false">Customer</button>
        <button class="tag" type="button" data-tag="One-of-One" aria-pressed="false">One-of-One</button>
        <button class="tag" type="button" data-tag="Shop/Studio Photos" aria-pressed="false">Shop/Studio Photos</button>
      </div>
    </section>

    <section class="about-card">
      <div class="grid" id="galleryGrid" aria-live="polite"></div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <span class="badge">US Veteran-inspired • Florida-built</span>
    </div>
  </footer>

  <!-- Lightbox -->
  <dialog class="lightbox-backdrop" id="lightbox" aria-label="Image preview">
    <button class="close-btn" data-close>&times; Close</button>
    <img class="lightbox-img" id="lightboxImg" alt="">
  </dialog>

  <script src="assets/js/util.js" defer></script>
  <script src="assets/js/config.js" defer></script>

  <!-- GALLERY ENGINE -->
  <script>
    const GRID   = document.getElementById('galleryGrid');
    const TAGS   = document.getElementById('tagbar');
    const dialog = document.getElementById('lightbox');
    const fullImg= document.getElementById('lightboxImg');

    // Load data & render
    fetch('assets/data/gallery.json')
      .then(r => r.ok ? r.json() : [])
      .then(items => {
        if (!Array.isArray(items)) items = [];
        render(items);      // draw everything
        setupFilters();     // wire up the 3 buttons
        // Optional deep link: gallery.html?tag=Customer
        const startTag = new URLSearchParams(location.search).get('tag');
        if (startTag) selectTag(startTag);
      })
      .catch(() => render([]));

    function render(items){
      GRID.innerHTML = items.map(it => `
        <figure data-tags="${(it.tags||[]).join('|')}">
          <img src="${it.src}" alt="${it.alt||'Freedom Crate photo'}" loading="lazy" data-full="${it.src}">
          <figcaption>${it.caption||''}</figcaption>
        </figure>
      `).join('') || `<p>No photos yet. Check back soon.</p>`;
    }

    // Use the 3 hard-coded buttons; show ALL by default
    function setupFilters(){
      TAGS.addEventListener('click', e => {
        if (!e.target.classList.contains('tag')) return;
        const tag = e.target.dataset.tag;
        selectTag(tag);
      });
    }

    function selectTag(tag){
      // toggle button UI
      TAGS.querySelectorAll('.tag').forEach(b => b.setAttribute('aria-pressed','false'));
      const btn = TAGS.querySelector(`[data-tag="${CSS.escape(tag)}"]`);
      if (btn) btn.setAttribute('aria-pressed','true');

      // filter figures
      [...GRID.children].forEach(fig => {
        const tags = (fig.dataset.tags || '').split('|').filter(Boolean);
        fig.style.display = tags.includes(tag) ? '' : 'none';
      });
    }

    // Lightbox
    GRID.addEventListener('click', e => {
      const t = e.target;
      if (t && t.tagName==='IMG'){
        fullImg.src = t.dataset.full || t.src;
        fullImg.alt = t.alt;
        dialog.showModal();
      }
    });
    dialog.addEventListener('click', e => {
      if (e.target.hasAttribute('data-close') || e.target === dialog) dialog.close();
    });
    addEventListener('keydown', e => {
      if (e.key === 'Escape' && dialog.open) dialog.close();
    });
  </script>
</body>
</html>