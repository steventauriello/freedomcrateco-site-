<!doctype html>
<html lang="en">
<head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DNNL0065X9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-DNNL0065X9');
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Transparency • Freedom Crate Co.</title>
  <meta name="description" content="Monthly transparency report for Freedom Crate Co.: revenue, costs, and how much we allocate to The Final Salute Project." />

  <meta name="robots" content="noindex, nofollow" />
  <meta property="og:title" content="Transparency • Freedom Crate Co." />
  <meta property="og:description" content="See how we split revenue between materials, operations, and The Final Salute Project each month." />
  <meta property="og:image" content="https://freedomcrateco.com/assets/img/hero-founding-fathers.jpg" />
  <meta property="og:site_name" content="Freedom Crate Co." />

  <link rel="icon" href="/assets/img/favicon.ico">
  <link rel="stylesheet" href="assets/css/styles.css" />

  <style>
    .hero-transparency { padding:3rem 1rem; text-align:center; }
    .hero-transparency h1 { font-size:clamp(2rem,2.8vw,3rem); margin-bottom:.5rem; }
    .hero-transparency p.lede { max-width:60ch; margin:.5rem auto 0; opacity:.9; }
    .badge-row { display:flex; flex-wrap:wrap; justify-content:center; gap:.5rem; margin-top:.75rem; }

    .about-card { border:1px solid rgba(255,255,255,.08); border-radius:.75rem; padding:1rem; background:rgba(255,255,255,.03); margin:1rem 0; }
    .about-card h2 { margin-top:0; }
    .muted { opacity:.8; }
    .small { font-size:.9rem; }
    .btn { display:inline-block; padding:.6rem .9rem; border-radius:.5rem; text-decoration:none; border:1px solid rgba(255,255,255,.16); }

    .kpis { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:.75rem; }
    .kpi { padding:.9rem; border:1px solid rgba(255,255,255,.08); border-radius:.75rem; background:rgba(255,255,255,.02); }
    .kpi .label { font-size:.9rem; opacity:.8; }
    .kpi .value { font-size:1.25rem; font-weight:700; margin-top:.25rem; }

    .table-wrap { overflow:auto; }
    table.fin-table { width:100%; border-collapse:collapse; font-size:.95rem; }
    table.fin-table th, table.fin-table td { padding:.6rem .5rem; border-bottom:1px solid rgba(255,255,255,.08); white-space:nowrap; }
    table.fin-table th { text-align:left; opacity:.9; }
    table.fin-table td.money { text-align:right; font-variant-numeric:tabular-nums; }
    table.fin-table tfoot td { font-weight:700; }

    .bar { height:10px; border-radius:999px; background:rgba(255,255,255,.08); overflow:hidden; }
    .bar > span { display:block; height:100%; background:currentColor; opacity:.8; }
    .bars { display:grid; gap:.4rem; margin:.4rem 0 .2rem; }
    .legend { display:flex; flex-wrap:wrap; gap:.5rem; font-size:.85rem; opacity:.9; }
    .pill { padding:.15rem .45rem; border-radius:.5rem; border:1px solid rgba(255,255,255,.18); }

    .controls { display:flex; gap:.5rem; flex-wrap:wrap; margin:.6rem 0; }
    .note { font-size:.9rem; opacity:.85; }
    .right { text-align:right; }

    /* Fallback badge style if your global CSS doesn’t define it */
    .badge{display:inline-block;padding:.25rem .5rem;border:1px solid rgba(255,255,255,.16);border-radius:.5rem;font-size:.85rem}
  </style>

  <!-- Structured data (optional) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"AboutPage",
    "name":"Transparency",
    "url":"https://freedomcrateco.com/transparency.html",
    "isPartOf":{"@type":"Organization","name":"Freedom Crate Co.","url":"https://freedomcrateco.com/"},
    "description":"Monthly transparency on revenue, costs, and donations/allocations to The Final Salute Project."
  }
  </script>
</head>

<body>
<header class="site-header">
  <a class="brand" href="/"><img src="assets/img/logo.png" alt="Freedom Crate Co." height="60"></a>
  <nav class="nav">
    <a href="/">Shop</a>
    <a href="about.html">About</a>
    <a href="gallery.html">Gallery</a>
    <a href="reviews.html">Reviews</a>
    <a href="transparency.html" aria-current="page">Transparency</a>
    <a href="contact.html">Custom Orders</a>
    <a href="checkout.html" class="cart-link">Cart (<span id="cartCount">0</span>)</a>
  </nav>
</header>

<main class="container">

  <!-- HERO -->
  <section class="hero-transparency">
    <h1>Transparency & Accountability</h1>
    <p class="lede">
      Freedom Crate Co. was built on craftsmanship, integrity, and purpose — and that extends to how we handle every dollar that comes in.
      This page exists to show exactly how our revenue is divided between <strong>materials, operations, and our nonprofit mission</strong> through
      <strong>The Final Salute Project</strong>.
    </p>

    <p class="lede" style="margin-top:1rem;">
      We believe that transparency isn’t a marketing angle — it’s a responsibility.
      Each sale helps us keep building better crates, stay self-sustaining as a small business, and most importantly, honor retiring veterans by
      gifting them personalized keepsake crates at no cost.
    </p>

    <div class="badge-row" style="margin-top:1rem;">
      <span class="badge">Integrity in Action</span>
      <span class="badge">Veteran-Focused Giving</span>
      <span class="badge">Small-Business Accountability</span>
      <span class="badge">Proudly Built in Florida</span>
    </div>
  </section>

  <!-- PHILOSOPHY -->
  <section class="about-card" id="transparency-philosophy">
    <h2>Why We Share Our Numbers</h2>
    <p>
      We believe small businesses should lead with honesty. For too long, consumers have been left guessing what’s behind the price tag — and many assume that
      any business owner must be wealthy. The truth is, most small businesses are built by hard-working families balancing costs, risk, and a dream.
    </p>
    <p>
      By opening our books and showing how every dollar is spent, we’re doing more than building trust — we’re helping people understand what it really takes
      to build something by hand, keep it affordable, and still give back. This level of transparency is our way of leading by example and setting a new
      standard for integrity in small business.
    </p>
    <p>
      If this inspires other makers, craftsmen, and entrepreneurs to do the same, then the movement toward <strong>open and honest business</strong> has already begun —
      and that’s something we can all be proud of.
    </p>
  </section>

  <!-- Methodology / Promise -->
  <section class="about-card">
    <h2>How We Calculate</h2>
    <p class="muted">
      Each month we tally gross revenue across our sales channels (website, eBay, Etsy). From that we track materials (wood, hardware, coatings),
      operating costs (shipping, fees, consumables), and then show the dollars allocated to <em>The Final Salute Project</em>.
      The remaining amount is reinvested to grow inventory and improve quality. Totals below are before income taxes.
    </p>
    <div class="controls">
      <a class="btn" href="https://finalsaluteproject.org" target="_blank" rel="noopener noreferrer">
  About The Final Salute Project
</a>
      <a class="btn" href="giveaway.html">Apply / Nominate a Veteran</a>
    </div>
  </section>

  <!-- KPIs -->
  <section class="about-card">
    <h2>Year-To-Date Snapshot</h2>
    <div class="kpis" id="kpis"></div>
    <p id="lastUpdated" class="muted small" style="margin-top:.5rem;"></p>
  </section>

  <!-- Monthly Table -->
  <section class="about-card">
    <h2>Monthly Breakdown</h2>
    <div class="controls">
      <label><input type="checkbox" id="showDetails" checked> Show details (materials & operations)</label>
    </div>
    <div class="table-wrap">
      <table class="fin-table" id="finTable">
        <thead>
          <tr>
            <th>Month</th>
            <th class="right">Revenue</th>
            <th class="right details">Materials</th>
            <th class="right details">Operations</th>
            <th class="right">Final Salute Allocation</th>
            <th class="right">Reinvest/Net*</th>
          </tr>
        </thead>
        <tbody><!-- rows via JS --></tbody>
        <tfoot>
          <tr>
            <td><strong>Totals (YTD)</strong></td>
            <td class="money" id="t_rev"></td>
            <td class="money details" id="t_mat"></td>
            <td class="money details" id="t_ops"></td>
            <td class="money" id="t_fsp"></td>
            <td class="money" id="t_net"></td>
          </tr>
        </tfoot>
      </table>
    </div>
    <p class="note muted">* “Reinvest/Net” = Revenue − (Materials + Operations + Final Salute Allocation)</p>
  </section>

  <!-- Visual bars -->
  <section class="about-card">
    <h2>Allocation Mix (Latest Month)</h2>
    <div id="bars" class="bars"></div>
    <div class="legend">
      <span class="pill">Revenue</span>
      <span class="pill">Materials</span>
      <span class="pill">Operations</span>
      <span class="pill">Final Salute Allocation</span>
      <span class="pill">Reinvest/Net</span>
    </div>
  </section>

  <!-- Footnote + Contact -->
  <section class="about-card">
    <p class="muted small">
      Questions about these numbers or our approach? <a href="mailto:support@freedomcrateco.com">Email us</a>.
      We’ll keep refining this page and may add third-party verification and automated data pulls as we grow.
    </p>
  </section>

</main>

<footer class="site-footer">
  <div class="container">
    <span class="badge">US Veteran-Inspired • Florida-Built</span>
  </div>
</footer>

<script>
/* ------------ Formatting helpers (safe with blanks) ------------ */
const currency = n =>
  (n == null || Number.isNaN(n)) ? '—'
  : `$${Number(n).toLocaleString(undefined,{minimumFractionDigits:0, maximumFractionDigits:0})}`;

const pct = (part, whole) =>
  (part == null || whole == null || whole <= 0) ? 0 : Math.round((part/whole)*100);

function computeNet(row){
  const { revenue, materials, operations, finalSalute } = row;
  if ([revenue, materials, operations, finalSalute].some(v => v == null || Number.isNaN(v))) return null;
  return revenue - (materials + operations + finalSalute);
}

/* ------------ Renderers (skip blanks in totals) ------------ */
function renderKPIs(rows){
  const add = (a,v)=> a + (Number.isFinite(v) ? v : 0);
  const totals = rows.reduce((t,r)=>({
    rev: add(t.rev, r.revenue),
    mat: add(t.mat, r.materials),
    ops: add(t.ops, r.operations),
    fsp: add(t.fsp, r.finalSalute),
    net: add(t.net, computeNet(r))
  }), {rev:0,mat:0,ops:0,fsp:0,net:0});

  const ytdAllocPct = totals.rev>0 ? Math.round((totals.fsp/totals.rev)*100) : 0;

  document.getElementById('kpis').innerHTML = `
    <div class="kpi"><div class="label">Revenue (YTD)</div><div class="value">${currency(totals.rev)}</div></div>
    <div class="kpi"><div class="label">Allocated to Final Salute (YTD)</div><div class="value">${currency(totals.fsp)} (${ytdAllocPct}%)</div></div>
    <div class="kpi"><div class="label">Materials + Operations (YTD)</div><div class="value">${currency(totals.mat + totals.ops)}</div></div>
    <div class="kpi"><div class="label">Reinvest/Net (YTD)</div><div class="value">${currency(totals.net)}</div></div>
  `;

  document.getElementById('t_rev').textContent = currency(totals.rev);
  document.getElementById('t_mat').textContent = currency(totals.mat);
  document.getElementById('t_ops').textContent = currency(totals.ops);
  document.getElementById('t_fsp').textContent = currency(totals.fsp);
  document.getElementById('t_net').textContent = currency(totals.net);

  // "Last updated" shows the latest month we actually have revenue for
  const latestWithData = [...rows].reverse().find(r => Number.isFinite(r.revenue));
  document.getElementById('lastUpdated').textContent =
    latestWithData ? `Last updated for ${latestWithData.month}` : '';
}

function renderTable(rows){
  const tbody = document.querySelector('#finTable tbody');
  tbody.innerHTML = rows.map(r=>{
    const net = computeNet(r);
    const rev = r.revenue;
    const fspPct = (rev == null) ? 0 : pct(r.finalSalute, rev);
    return `
      <tr>
        <td>${r.month || '—'}</td>
        <td class="money">${currency(r.revenue)}</td>
        <td class="money details">${currency(r.materials)}</td>
        <td class="money details">${currency(r.operations)}</td>
        <td class="money">${currency(r.finalSalute)}${rev==null?'':` (${fspPct}%)`}</td>
        <td class="money">${currency(net)}</td>
      </tr>
    `;
  }).join('');
}

function renderBars(latest){
  const bars = document.getElementById('bars');
  if(!latest){ bars.innerHTML = '<p class="muted">No data yet.</p>'; return; }

  // If the newest month is blank, fall back to the latest month that has revenue
  let ref = latest;
  if (latest.revenue == null) {
    const allRows = window.__rows || [];
    ref = [...allRows].reverse().find(r => Number.isFinite(r.revenue)) || null;
  }
  if (!ref) { bars.innerHTML = '<p class="muted">No month has data yet.</p>'; return; }

  const net = computeNet(ref);
  const rev = Math.max(ref.revenue, 1);

  const makeBar = (label, value) => {
    const w = Math.max(0, Math.min(100, pct(value, rev)));
    return `
      <div>
        <div class="right small" style="opacity:.85;margin-bottom:.15rem;">${label}: ${currency(value)} (${w}%)</div>
        <div class="bar"><span style="width:${w}%"></span></div>
      </div>`;
  };

  bars.innerHTML = [
    makeBar(`Revenue (${ref.month})`, rev),
    makeBar('Materials', ref.materials),
    makeBar('Operations', ref.operations),
    makeBar('Final Salute Allocation', ref.finalSalute),
    makeBar('Reinvest/Net', net)
  ].join('');
}

function toggleDetails(show){
  document.querySelectorAll('.details').forEach(el=>{
    el.style.display = show ? '' : 'none';
  });
}

/* ------------ Data loading with "current month blank" behavior ------------ */
// Default % used when revenue is present but a field is omitted
const DEFAULT_RATES = {
  materials: 0.46,   // 46% of revenue
  operations: 0.18,  // 18%
  finalSalute: 0.05  // 5%
};

// Month helpers
const toYM = (y,m) => `${y}-${String(m).padStart(2,'0')}`;
function nextMonthStr(s){
  const [y,m] = String(s||'').split('-').map(Number);
  const d = new Date(y, (m||1)-1, 1);
  d.setMonth(d.getMonth()+1);
  return toYM(d.getFullYear(), d.getMonth()+1);
}
function currentMonthYM(){
  const d = new Date(); // uses visitor's local time; that's fine
  return toYM(d.getFullYear(), d.getMonth()+1);
}

fetch('/assets/data/transparency.json')
  .then(res => {
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    return res.json();
  })
  .then(rawRows => {
    // Keep only rows that at least have a month string
    const clean = (rawRows||[]).filter(r => r && r.month);
    clean.sort((a,b)=> String(a.month||'').localeCompare(String(b.month||'')));
    if (clean.length === 0) throw new Error('No rows with a "month" key found.');

    const byMonth = new Map(clean.map(r => [r.month, r]));
    const first = clean[0].month;
    const lastWanted = currentMonthYM(); // include the current month, which may be blank

    // Build inclusive month list from first data month through current month
    const months = [];
    for (let cur = first; ; cur = nextMonthStr(cur)) {
      months.push(cur);
      if (cur === lastWanted) break;
    }

    // Build rows; if a month isn't in JSON, insert a blank row (—)
    const rows = months.map(month => {
      const r = byMonth.get(month);
      if (!r) return { month, revenue: null, materials: null, operations: null, finalSalute: null };

      const revenue = (r.revenue != null) ? Number(r.revenue) : null;
      const materials   = (r.materials   != null) ? Number(r.materials)
                        : (revenue != null ? Math.round(revenue * DEFAULT_RATES.materials) : null);
      const operations  = (r.operations  != null) ? Number(r.operations)
                        : (revenue != null ? Math.round(revenue * DEFAULT_RATES.operations) : null);
      const finalSalute = (r.finalSalute != null) ? Number(r.finalSalute)
                        : (revenue != null ? Math.round(revenue * DEFAULT_RATES.finalSalute) : null);

      return { month, revenue, materials, operations, finalSalute };
    });

    // Expose rows for renderBars fallback
    window.__rows = rows;

    renderTable(rows);
    renderKPIs(rows);
    renderBars(rows[rows.length - 1]); // will auto-fallback if latest is blank

    const checkbox = document.getElementById('showDetails');
    toggleDetails(checkbox.checked);
    checkbox.addEventListener('change', () => toggleDetails(checkbox.checked));
  })
  .catch(err => {
    console.error('Error loading transparency data:', err);
    document.getElementById('bars').innerHTML = '<p class="muted">Data unavailable. Please check back soon.</p>';
  });
</script>

</body>
</html>
