<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Branch Collection – Freedom Crate Co.</title>
  <meta name="description" content="Freedom Crate Co. Branch Collection – handcrafted ammo boxes honoring the U.S. Army, Marines, Navy, Air Force, and Coast Guard." />
  <link rel="stylesheet" href="assets/css/styles.css" />
  <style>
    .product-page { max-width: 900px; margin: 2rem auto; padding: 1rem; }

    /* Gallery: single column (right-side branch thumbs removed) */
    .gallery { display: grid; grid-template-columns: 1fr; gap: 1rem; }
    .gallery-main { position: relative; }
    .gallery-main img { width: 100%; border-radius: 12px; cursor: pointer; }

    /* Lightbox */
    .lightbox { position: fixed; inset: 0; background: rgba(0,0,0,.9); display: none; align-items: center; justify-content: center; z-index: 9999; }
    .lightbox.open { display: flex; }
    .lightbox img { max-width: 90%; max-height: 90%; border-radius: 12px; }
    .lightbox .close { position: absolute; top: 20px; right: 30px; font-size: 2rem; background: none; border: none; color: #fff; cursor: pointer; }

    /* Details / CTA */
    .bc-details { margin-top: 1.25rem; }
    .bc-details h2 { margin: 0 0 .25rem; }
    .bc-bullets, .bc-specs ul { margin: .5rem 0 1rem 1.2rem; }
    .bc-bullets li, .bc-specs li { margin: .25rem 0; }
    .bc-cta { display:flex; align-items:center; gap:1rem; margin-top:.5rem; }
    .bc-cta small { display:block; }

    /* Bottom description photo strip */
    .desc-photos { margin-top: 1rem; }
    .desc-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
    }
    .desc-thumb { padding: 0; border: 0; background: transparent; cursor: zoom-in; display: block; }
    .desc-thumb img {
      width: 100%; height: 100%; object-fit: cover;
      border-radius: 8px; box-shadow: 0 1px 4px rgba(0,0,0,.15);
      transition: transform .15s ease;
    }
    .desc-thumb img:hover { transform: scale(1.02); }

    /* Arrows on the main hero image */
    .gallery-arrow {
      position: absolute; top: 50%; transform: translateY(-50%);
      background: rgba(0,0,0,.45); color: #fff; border: 0; width: 40px; height: 48px;
      border-radius: 6px; cursor: pointer; font-size: 28px; line-height: 1;
      display: flex; align-items: center; justify-content: center;
    }
    .gallery-arrow.prev { left: 8px; }
    .gallery-arrow.next { right: 8px; }
    .gallery-arrow:hover { background: rgba(0,0,0,.6); }
    .gallery-arrow:focus { outline: 2px solid #fff; outline-offset: 2px; }

    @media (max-width: 780px){
      .bc-cta { flex-wrap: wrap; gap:.5rem; }
      .desc-grid { grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); }
      .gallery-arrow { width: 36px; height: 44px; font-size: 24px; }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <a class="brand" href="index.html">
      <img src="assets/img/logo.png" alt="Freedom Crate Co. Logo">
    </a>
    <nav class="nav" aria-label="Primary">
      <a href="index.html">Shop</a>
      <a href="about.html">About</a>
      <a href="gallery.html">Gallery</a>
      <a href="reviews.html">Reviews</a>
      <a href="contact.html">Custom Orders</a>
      <a href="checkout.html" class="cart-link">Cart (<span id="cartCount">0</span>)</a>
    </nav>
  </header>

  <main class="product-page">
    <h1>Freedom Crate Classic — Branch Collection</h1>
    <p class="muted">Handcrafted wooden ammo/range boxes honoring every branch of the U.S. Armed Forces. Built tough, stenciled with pride, and finished in service green.</p>

    <!-- Gallery (hero only; arrows cycle bottom photos) -->
    <div class="gallery">
      <div class="gallery-main">
        <img id="bc-hero" src="assets/img/airforce.jpg" alt="airforce crate – Freedom Crate Classic" tabindex="0">
        <button class="gallery-arrow prev" type="button" aria-label="Previous photo">‹</button>
        <button class="gallery-arrow next" type="button" aria-label="Next photo">›</button>
      </div>
    </div>

   <!-- Bottom Description Photos (click-to-zoom only) -->
<section class="desc-photos" aria-label="More photos of the Freedom Crate Classic">
  <div class="desc-grid">
    <button class="desc-thumb"
            data-full="assets/img/branch-collection-side-stack.jpg"
            aria-label="Freedom Crate Classic side stacked view, large">
      <img loading="lazy"
           src="assets/img/branch-collection-side-stack.jpg"
           alt="Freedom Crate Classic side stacked view detail">
    </button>

    <button class="desc-thumb"
            data-full="assets/img/fc-blank-back.jpg"
            aria-label="Freedom Crate Classic blank crate back view, large">
      <img loading="lazy"
           src="assets/img/fc-blank-back.jpg"
           alt="Freedom Crate Classic blank crate back view detail">
    </button>

    <button class="desc-thumb"
            data-full="assets/img/freedom-crate-classic-top.jpg"
            aria-label="Freedom Crate Classic top view, large">
      <img loading="lazy"
           src="assets/img/freedom-crate-classic-top.jpg"
           alt="Freedom Crate Classic top view detail">
    </button>

    <button class="desc-thumb"
            data-full="assets/img/freedom-crate-open-lid.jpg"
            aria-label="Freedom Crate Classic open lid view, large">
      <img loading="lazy"
           src="assets/img/freedom-crate-open-lid.jpg"
           alt="Freedom Crate Classic open lid view detail">
    </button>

    <button class="desc-thumb"
            data-full="assets/img/freedom-crate-stainless-hinge.jpg"
            aria-label="Freedom Crate Classic stainless hinge detail, large">
      <img loading="lazy"
           src="assets/img/freedom-crate-stainless-hinge.jpg"
           alt="Freedom Crate Classic stainless hinge detail">
    </button>

    <button class="desc-thumb"
            data-full="assets/img/fc-blank-angle.jpg"
            aria-label="Freedom Crate Classic blank crate angle view, large">
      <img loading="lazy"
           src="assets/img/fc-blank-angle.jpg"
           alt="Freedom Crate Classic blank crate angle view">
    </button>
  </div>
</section>
    <!-- Details / Specs -->
    <div class="bc-details">
      <h2>Specifications</h2>
      <ul>
        <li><strong>Interior Dimensions:</strong> 11″ W × 8¼″ L × 5½″ D</li>
        <li><strong>Exterior Dimensions:</strong> 14″ W × 9½″ L × 7″ H</li>
        <li><strong>Construction:</strong> 3/4 UTX exterior-grade plywood for ultra durability</li>
        <li><strong>Bottom Panel:</strong> ¼″ sanded plywood</li>
        <li><strong>Lid:</strong> Reinforced ¾″ solid pine tongue-and-groove boards</li>
        <li><strong>Paint:</strong> Ultra-flat OD Green (olive drab camouflage)</li>
        <li><strong>Hardware:</strong> Dual stainless steel or black steel lockable toggle latches</li>
        <li><strong>Hinges:</strong> 1½″ stainless steel rear hinges</li>
        <li><strong>Handles:</strong> Heavy-duty nylon webbing, integrated into reinforced legs</li>
        <li><strong>Branches Available:</strong> U.S. Army, U.S. Marine Corps, U.S. Navy, U.S. Air Force, U.S. Coast Guard, or Blank (no stencil)</li>
      </ul>

      <h2>Details</h2>
      <ul>
        <li>Reinforced lid rails for added strength and long-term durability</li>
        <li>Raised legs allow boxes to be stackable without damaging lids</li>
        <li>Leg design houses the nylon webbing handles internally, preventing wiggle or break-free issues</li>
        <li>Handles tested to withstand well over 300 lbs — nearly fail-safe under normal use</li>
        <li>Every box is stenciled with pride (or left blank for a clean, no-insignia look)</li>
        <li>Future premium line will offer hardwood maple plywood upgrades</li>
        <li>Free shipping — some orders may ship in two packages (both tracking numbers provided)</li>
      </ul>
    </div>

    <div class="bc-cta">
      <strong>Total: <span id="bc-price">$95.00</span></strong>
      <button id="bc-add" class="btn">Add to Cart</button>
      <small class="muted">Price shown for stenciled branch. “Blank” is $89.99 (available on main Shop card).</small>
    </div>
  </main>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <button class="close" aria-label="Close" id="lbClose">×</button>
    <img id="lbImg" alt="">
  </div>

  <!-- Core helpers (your existing files) -->
  <script src="assets/js/util.js" defer></script>
  <script src="assets/js/cart.js" defer></script>

  <script>
  (function(){
    // --- Gallery + Lightbox (existing behavior)
    const hero   = document.getElementById('bc-hero');
    const lb     = document.getElementById('lightbox');
    const lbImg  = document.getElementById('lbImg');
    const lbClose= document.getElementById('lbClose');

    function openLB(src, alt){ lbImg.src = src; lbImg.alt = alt||''; lb.classList.add('open'); lb.setAttribute('aria-hidden','false'); }
    function closeLB(){ lb.classList.remove('open'); lb.setAttribute('aria-hidden','true'); lbImg.src=''; }

    hero.addEventListener('click', () => openLB(hero.src, hero.alt));
    lb.addEventListener('click', e => { if (e.target === lb) closeLB(); });
    lbClose.addEventListener('click', closeLB);
    document.addEventListener('keydown', e => { if (e.key === 'Escape') closeLB(); });

    // --- Cart wiring (unchanged; gallery no longer affects price)
    const PRICES = { blank:89.99, army:95.00, marines:95.00, navy:95.00, airforce:95.00, coastguard:95.00 };
    const SKUS   = {
      blank:'classic-blank-stainless',
      army:'classic-army-stainless',
      marines:'classic-marines-stainless',
      navy:'classic-navy-stainless',
      airforce:'classic-airforce-stainless',
      coastguard:'classic-coastguard-stainless'
    };

    const priceEl = document.getElementById('bc-price');
    const addBtn  = document.getElementById('bc-add');
    let currentBranch = 'airforce'; // keep default as before

    function inferBranchFromHero() {
      const alt = (hero.alt||'').toLowerCase();
      for (const k of Object.keys(PRICES)) if (alt.includes(k)) return k;
      const src = (hero.src||'').toLowerCase();
      for (const k of Object.keys(PRICES)) if (src.includes(k)) return k;
      return currentBranch;
    }
    function renderPrice(){ priceEl.textContent = '$'+(PRICES[currentBranch]||95).toFixed(2); }
    function updateBranchFromHero(){ currentBranch = inferBranchFromHero(); renderPrice(); }

    addBtn.addEventListener('click', () => {
      const branch = currentBranch;
      const sku  = SKUS[branch] || SKUS.marines;
      const name = 'Freedom Crate Classic — ' + (branch==='blank' ? 'Blank' :
                   branch.charAt(0).toUpperCase()+branch.slice(1)) + ' • Stainless';
      const price= PRICES[branch] || 95.00;

      if (typeof window.addToCart === 'function') {
        window.addToCart(sku, name, price, 1, { image: hero.src });
      } else if (typeof window.addItem === 'function') {
        window.addItem({ sku, name, price, qty:1, image: hero.src });
      } else {
        alert('Cart is not ready.');
      }
    });

    // initial render
    updateBranchFromHero();

    // --- Bottom description photos -> open lightbox AND (optionally) sync hero
    const desc = document.querySelector('.desc-photos');
    desc?.addEventListener('click', (e) => {
      const btn = e.target.closest('.desc-thumb');
      if(!btn) return;
      const full = btn.getAttribute('data-full');
      const alt  = btn.querySelector('img')?.getAttribute('alt') || '';
      // show in hero (so arrows continue from this)
      hero.src = full; hero.alt = alt;
      openLB(full, alt);
    });

    // --- Arrows cycle through bottom description photos
    const photos = Array.from(document.querySelectorAll('.desc-photos .desc-thumb img'));
    function currentIndex(){
      const hs = (hero.src||'').toLowerCase();
      let idx = photos.findIndex(p => hs.endsWith((p.getAttribute('src')||'').toLowerCase()));
      if (idx === -1) idx = 0;
      return idx;
    }
    function showIndex(i){
      if (!photos.length) return;
      const len = photos.length;
      const idx = ((i % len) + len) % len;
      const img = photos[idx];
      const src = img.getAttribute('src');
      const alt = img.getAttribute('alt') || '';
      hero.src = src; hero.alt = alt;
    }

    const prevBtn = document.querySelector('.gallery-arrow.prev');
    const nextBtn = document.querySelector('.gallery-arrow.next');
    prevBtn?.addEventListener('click', e => { e.stopPropagation(); showIndex(currentIndex()-1); });
    nextBtn?.addEventListener('click', e => { e.stopPropagation(); showIndex(currentIndex()+1); });

    // Keyboard left/right when hero focused
    document.querySelector('.gallery-main')?.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft')  { e.preventDefault(); showIndex(currentIndex()-1); }
      if (e.key === 'ArrowRight') { e.preventDefault(); showIndex(currentIndex()+1); }
    });
  })();
  </script>
</body>
</html>